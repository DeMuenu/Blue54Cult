<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Poi Ipsum Generator</title>
  <style>
    :root{
      --bg: #0b0f14;
      --panel:#111823;
      --muted:#6b7a90;
      --text:#e6edf6;
      --accent:#7aa2ff;
      --accent-2:#acf5ff;
      --ring:#264a9c;
      --card:#0e141c;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background:
        radial-gradient(1200px 600px at 85% -10%, rgba(122,162,255,.20), transparent 60%),
        radial-gradient(900px 500px at -10% 110%, rgba(172,245,255,.12), transparent 60%),
        var(--bg);
      color:var(--text);
      font: 15px/1.5 ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
      display:grid;
      place-items: center;
      padding:24px;
    }
    .app{
      width:min(100%, 980px);
      display:grid;
      gap:16px;
    }
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    h1{
      margin:0;
      font-size: clamp(20px, 2vw + 12px, 34px);
      letter-spacing:.2px;
      display:flex;
      align-items:center;
      gap:10px;
    }
    h1 .badge{font-size:.6em;color:var(--accent-2);background:#14304f;border:1px solid #265575;padding:.16em .5em;border-radius:999px}

    .panel{
      background:linear-gradient(180deg, rgba(255,255,255,.02), transparent), var(--panel);
      border:1px solid #1a2332;
      border-radius:16px;
      box-shadow: 0 8px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.03);
      padding:16px;
    }
    .controls{ display:grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap:12px; align-items:end }
    .control{
      display:grid; gap:6px;
    }
    label{color:var(--muted); font-size:12px}
    input[type="number"], input[type="range"], select, button{ 
      background: var(--card);
      color: var(--text);
      border:1px solid #203049;
      border-radius:10px;
      padding:10px 12px;
      outline: none;
      transition:.15s ease;
    }
    input[type="number"]:focus, input[type="range"]:focus, select:focus, button:focus{ box-shadow: 0 0 0 4px var(--ring) }
    input[type="range"]{ height:34px }
    .actions{ display:flex; gap:10px; flex-wrap:wrap }
    button{ cursor:pointer; font-weight:600 }
    button.primary{ background:linear-gradient(180deg, rgba(122,162,255,.15), rgba(122,162,255,.05)), #12203a; border-color:#2f4d93 }
    button.ghost{ background:transparent }

    .output.panel{ padding:20px }
    .output p{ margin:0 0 1em 0; text-wrap: pretty }
    .output p:last-child{ margin-bottom:0 }

    details{
      background: #0d1521;
      border:1px dashed #22314c;
      border-radius:12px;
      padding:10px 12px;
      color:#a9b7cd;
    }
    summary{ cursor:pointer; font-weight:600 }
    .hint{ color:var(--muted); font-size:12px }
    .kbd{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background:#0a111d; border:1px solid #1a2a46; padding:.1em .45em; border-radius:6px }
    footer{ color:#8ea2be; font-size:12px; text-align:center }
    .sep{ height:1px; background:#1a2332; margin:6px 0 10px }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1>Poi Ipsum <span class="badge">Generator</span></h1>
      <div class="actions">
        <button class="ghost" id="copyBtn" title="Copy to clipboard">Copy</button>
        <button class="primary" id="genBtn" title="Generate">Generate</button>
      </div>
    </header>

    <section class="panel controls" aria-label="Generator Controls">
      <div class="control">
        <label for="paras">Paragraphs</label>
        <input id="paras" type="number" min="1" max="12" value="3" />
      </div>
      <div class="control">
        <label for="sentMin">Sentences / paragraph</label>
        <input id="sentMin" type="number" min="1" max="15" value="3" />
      </div>
      <div class="control">
        <label for="sentMax" aria-hidden="true" style="visibility:hidden">.</label>
        <input id="sentMax" type="number" min="1" max="15" value="6" />
      </div>
      <div class="control">
        <label for="wordMin">Words / sentence</label>
        <input id="wordMin" type="number" min="1" max="24" value="6" />
      </div>
      <div class="control">
        <label for="wordMax" aria-hidden="true" style="visibility:hidden">.</label>
        <input id="wordMax" type="number" min="1" max="24" value="12" />
      </div>
      <div class="control">
        <label for="oMin">o's per word</label>
        <input id="oMin" type="number" min="1" max="24" value="1" />
      </div>
      <div class="control">
        <label for="oMax" aria-hidden="true" style="visibility:hidden">.</label>
        <input id="oMax" type="number" min="1" max="24" value="10" />
      </div>
      <div class="control">
        <label for="punct">Punctuation</label>
        <select id="punct">
          <option value="light" selected>Light</option>
          <option value="none">None</option>
          <option value="spicy">Spicy</option>
        </select>
      </div>
    </section>

    <details>
      <summary>Advanced</summary>
      <div class="sep"></div>
      <div class="controls" style="margin-top:8px">
        <div class="control">
          <label for="blueRate">Blue54 chance (1 in …)</label>
          <input id="blueRate" type="number" min="50" max="100000" value="1000" />
          <div class="hint">Very slim by default. Lower number = more likely.</div>
        </div>
        <div class="control">
          <label for="skew">o-length bias</label>
          <input id="skew" type="range" min="1" max="3" step="0.1" value="1.6" />
          <div class="hint">Higher = more short <span class="kbd">o</span>s</div>
        </div>
        <div class="control">
          <label for="titlecase">Capitalize sentence starts</label>
          <select id="titlecase">
            <option value="yes" selected>Yes</option>
            <option value="no">No</option>
          </select>
        </div>
      </div>
    </details>

    <section class="output panel" id="out" aria-live="polite"></section>
    <footer>
      Tip: press <span class="kbd">G</span> to generate, <span class="kbd">C</span> to copy.
    </footer>
  </div>

  <script>
    // Utilities
    const randInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
    const weightedInt = (min, max, skew=1.6) => {
      const r = Math.random() ** skew; // skew>1 biases toward 0
      const range = max - min + 1;
      return min + Math.min(Math.floor(r * range), range - 1);
    };

    function makePoiWord(oMin, oMax, skew, blueRate){
      if (Math.random() < 1 / Math.max(1, blueRate)) return "Blue54"; // very slim easter egg
      const oCount = weightedInt(oMin, oMax, skew);
      return `P${"o".repeat(oCount)}i`;
    }

    function makeSentence(opts){
      const wc = randInt(opts.wordMin, opts.wordMax);
      const words = Array.from({length: wc}, () => makePoiWord(opts.oMin, opts.oMax, opts.skew, opts.blueRate));

      let s = words.join(" ");
      if (opts.titlecase && s.length) s = s[0].toUpperCase() + s.slice(1);

      if (opts.punct === 'light'){
        const end = Math.random();
        s += end < .85 ? '.' : end < .95 ? '!' : '?';
      } else if (opts.punct === 'spicy'){
        // sprinkle a couple of commas inside and varied endings
        if (wc > 6){
          const commaAt = randInt(2, Math.max(2, wc-3));
          const parts = s.split(' ');
          parts[commaAt] += ',';
          s = parts.join(' ');
        }
        const end = Math.random();
        s += end < .70 ? '.' : end < .88 ? '!' : end < .97 ? '?' : '…';
      }
      return s;
    }

    function makeParagraph(opts){
      const sc = randInt(opts.sentMin, opts.sentMax);
      return Array.from({length: sc}, () => makeSentence(opts)).join(' ');
    }

    function generate(){
      // read inputs & coerce
      const get = id => document.getElementById(id);
      const opts = {
        paras: +get('paras').value || 3,
        sentMin: Math.max(1, +get('sentMin').value || 3),
        sentMax: Math.max(1, +get('sentMax').value || 6),
        wordMin: Math.max(1, +get('wordMin').value || 6),
        wordMax: Math.max(1, +get('wordMax').value || 12),
        oMin: Math.max(1, +get('oMin').value || 1),
        oMax: Math.max(1, +get('oMax').value || 10),
        punct: get('punct').value,
        blueRate: Math.max(1, +get('blueRate').value || 1000),
        skew: +get('skew').value || 1.6,
        titlecase: get('titlecase').value === 'yes',
      };

      // ensure mins <= maxes
      if (opts.sentMin > opts.sentMax) [opts.sentMin, opts.sentMax] = [opts.sentMax, opts.sentMin];
      if (opts.wordMin > opts.wordMax) [opts.wordMin, opts.wordMax] = [opts.wordMax, opts.wordMin];
      if (opts.oMin > opts.oMax) [opts.oMin, opts.oMax] = [opts.oMax, opts.oMin];

      const out = document.getElementById('out');
      out.innerHTML = Array.from({length: opts.paras}, () => `<p>${makeParagraph(opts)}</p>`).join('');

      // update URL params for shareable state
      const params = new URLSearchParams({
        p: opts.paras, s: `${opts.sentMin}-${opts.sentMax}`, w: `${opts.wordMin}-${opts.wordMax}`,
        o: `${opts.oMin}-${opts.oMax}`, pu: opts.punct, b: opts.blueRate, k: opts.skew, t: opts.titlecase ? 1 : 0
      });
      history.replaceState({}, '', `${location.pathname}?${params.toString()}`);
    }

    function copyOut(){
      const out = document.getElementById('out');
      const text = Array.from(out.querySelectorAll('p')).map(p => p.textContent).join('\n\n');
      navigator.clipboard?.writeText(text).then(()=>{
        toast('Copied!');
      }).catch(()=>{
        // fallback
        const ta = document.createElement('textarea');
        ta.value = text; document.body.appendChild(ta); ta.select(); document.execCommand('copy'); ta.remove();
        toast('Copied!');
      });
    }

    function toast(msg){
      const el = document.createElement('div');
      el.textContent = msg;
      el.style.cssText = `position:fixed;inset:auto 0 20px 0; margin:auto; width:max-content; max-width:80%; padding:10px 14px; border-radius:999px; background:#0f1a2b; color:#cfe3ff; border:1px solid #24406f; box-shadow:0 8px 24px rgba(0,0,0,.4); text-align:center; z-index:9999;`;
      document.body.appendChild(el);
      setTimeout(()=>{ el.remove(); }, 1100);
    }

    // Wire up UI
    document.getElementById('genBtn').addEventListener('click', generate);
    document.getElementById('copyBtn').addEventListener('click', copyOut);
    document.addEventListener('keydown', (e)=>{
      if (e.key.toLowerCase() === 'g') { e.preventDefault(); generate(); }
      if (e.key.toLowerCase() === 'c') { e.preventDefault(); copyOut(); }
    });

    // Load state from URL if present
    (function initFromUrl(){
      const q = new URLSearchParams(location.search);
      if (!q.size) return generate();
      const get = id => document.getElementById(id);
      const setNumPair = (queryKey, minId, maxId) => {
        const v = q.get(queryKey);
        if (!v) return; const [a,b] = v.split('-').map(Number);
        if (!Number.isNaN(a)) get(minId).value = a;
        if (!Number.isNaN(b)) get(maxId).value = b;
      };
      if (q.get('p')) get('paras').value = +q.get('p');
      setNumPair('s','sentMin','sentMax');
      setNumPair('w','wordMin','wordMax');
      setNumPair('o','oMin','oMax');
      if (q.get('pu')) get('punct').value = q.get('pu');
      if (q.get('b')) get('blueRate').value = +q.get('b');
      if (q.get('k')) get('skew').value = +q.get('k');
      if (q.get('t')) get('titlecase').value = +q.get('t') ? 'yes' : 'no';
      generate();
    })();
  </script>
</body>
</html>
